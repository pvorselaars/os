#include "vga.h"

// Basic 8x16 font data for ASCII characters 0x20-0x7F
// Each character is 16 bytes (16 rows of 8 pixels each)

// Oct   Dec   Hex   Char                      │ Oct   Dec   Hex   Char
// ────────────────────────────────────────────┼───────────────────────────
// 000   0     00    NUL '\0' (null character) │ 100   64    40    @
// 001   1     01    SOH (start of heading)    │ 101   65    41    A
// 002   2     02    STX (start of text)       │ 102   66    42    B
// 003   3     03    ETX (end of text)         │ 103   67    43    C
// 004   4     04    EOT (end of transmission) │ 104   68    44    D
// 005   5     05    ENQ (enquiry)             │ 105   69    45    E
// 006   6     06    ACK (acknowledge)         │ 106   70    46    F
// 007   7     07    BEL '\a' (bell)           │ 107   71    47    G
// 010   8     08    BS  '\b' (backspace)      │ 110   72    48    H
// 011   9     09    HT  '\t' (horizontal tab) │ 111   73    49    I
// 012   10    0A    LF  '\n' (new line)       │ 112   74    4A    J
// 013   11    0B    VT  '\v' (vertical tab)   │ 113   75    4B    K
// 014   12    0C    FF  '\f' (form feed)      │ 114   76    4C    L
// 015   13    0D    CR  '\r' (carriage ret)   │ 115   77    4D    M
// 016   14    0E    SO  (shift out)           │ 116   78    4E    N
// 017   15    0F    SI  (shift in)            │ 117   79    4F    O
// 020   16    10    DLE (data link escape)    │ 120   80    50    P
// 021   17    11    DC1 (device control 1)    │ 121   81    51    Q
// 022   18    12    DC2 (device control 2)    │ 122   82    52    R
// 023   19    13    DC3 (device control 3)    │ 123   83    53    S
// 024   20    14    DC4 (device control 4)    │ 124   84    54    T
// 025   21    15    NAK (negative ack.)       │ 125   85    55    U
// 026   22    16    SYN (synchronous idle)    │ 126   86    56    V
// 027   23    17    ETB (end of trans. blk)   │ 127   87    57    W
// 030   24    18    CAN (cancel)              │ 130   88    58    X
// 031   25    19    EM  (end of medium)       │ 131   89    59    Y
// 032   26    1A    SUB (substitute)          │ 132   90    5A    Z
// 033   27    1B    ESC (escape)              │ 133   91    5B    [
// 034   28    1C    FS  (file separator)      │ 134   92    5C    \  '\\'
// 035   29    1D    GS  (group separator)     │ 135   93    5D    ]
// 036   30    1E    RS  (record separator)    │ 136   94    5E    ^
// 037   31    1F    US  (unit separator)      │ 137   95    5F    _
// 040   32    20    SPACE                     │ 140   96    60    `
// 041   33    21    !                         │ 141   97    61    a
// 042   34    22    "                         │ 142   98    62    b
// 043   35    23    #                         │ 143   99    63    c
// 044   36    24    $                         │ 144   100   64    d
// 045   37    25    %                         │ 145   101   65    e
// 046   38    26    &                         │ 146   102   66    f
// 047   39    27    '                         │ 147   103   67    g
// 050   40    28    (                         │ 150   104   68    h
// 051   41    29    )                         │ 151   105   69    i
// 052   42    2A    *                         │ 152   106   6A    j
// 053   43    2B    +                         │ 153   107   6B    k
// 054   44    2C    ,                         │ 154   108   6C    l
// 055   45    2D    -                         │ 155   109   6D    m
// 056   46    2E    .                         │ 156   110   6E    n
// 057   47    2F    /                         │ 157   111   6F    o
// 060   48    30    0                         │ 160   112   70    p
// 061   49    31    1                         │ 161   113   71    q
// 062   50    32    2                         │ 162   114   72    r
// 063   51    33    3                         │ 163   115   73    s
// 064   52    34    4                         │ 164   116   74    t
// 065   53    35    5                         │ 165   117   75    u
// 066   54    36    6                         │ 166   118   76    v
// 067   55    37    7                         │ 167   119   77    w
// 070   56    38    8                         │ 170   120   78    x
// 071   57    39    9                         │ 171   121   79    y
// 072   58    3A    :                         │ 172   122   7A    z
// 073   59    3B    ;                         │ 173   123   7B    {
// 074   60    3C    <                         │ 174   124   7C    |
// 075   61    3D    =                         │ 175   125   7D    }
// 076   62    3E    >                         │ 176   126   7E    ~
// 077   63    3F    ?                         │ 177   127   7F    DEL

// TODO: full font for extended ASCII
static const uint8_t vga_font[96][16] = {
    // 0x20 - Space
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x21 - !
    {
        0b00000000,
        0b00000000,
        0b00011000,
        0b00111100,
        0b00111100,
        0b00111100,
        0b00111100,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x22 - "
    {
        0b00000000,
        0b01100110,
        0b01100110,
        0b01100110,
        0b00100100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x23 - #
    {
        0b00000000,
        0b00000000,
        0b01100110,
        0b01100110,
        0b01100110,
        0b11111111,
        0b01100110,
        0b01100110,
        0b11111111,
        0b01100110,
        0b01100110,
        0b01100110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x24 - $
    {
        0b00011000,
        0b00011000,
        0b01111100,
        0b11000110,
        0b11000010,
        0b11000000,
        0b01111100,
        0b00000110,
        0b00000110,
        0b10000110,
        0b11000110,
        0b01111100,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000
    },
    // 0x25 - %
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11000010,
        0b11000110,
        0b00001100,
        0b00011000,
        0b00110000,
        0b01100000,
        0b11000110,
        0b10000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x26 - &
    {
        0b00000000,
        0b00000000,
        0b00111000,
        0b01101100,
        0b01101100,
        0b00111000,
        0b01110110,
        0b11011100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b01110110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x27 - '
    {
        0b00000000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b01100000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x28 - (
    {
        0b00000000,
        0b00000000,
        0b00001100,
        0b00011000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00011000,
        0b00001100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x29 - )
    {
        0b00000000,
        0b00000000,
        0b00110000,
        0b00011000,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00011000,
        0b00110000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x2A - *
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01100110,
        0b00111100,
        0b11111111,
        0b00111100,
        0b01100110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x2B - +
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b01111110,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x2C - ,
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00110000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x2D - -
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x2E - .
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x2F - /
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000010,
        0b00000110,
        0b00001100,
        0b00011000,
        0b00110000,
        0b01100000,
        0b01000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x30 - 0
    {
        0b00000000,
        0b00000000,
        0b01111110,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11011011,
        0b11011011,
        0b11000011,
        0b11000011,
        0b11000011,
        0b01111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x31 - 1
    {
        0b00000000,
        0b00000000,
        0b00011000,
        0b01111000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b01111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x32 - 2
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b00000110,
        0b00001100,
        0b00011000,
        0b00110000,
        0b01100000,
        0b11000110,
        0b11111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x33 - 3
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b00000110,
        0b00000110,
        0b00111100,
        0b00000110,
        0b00000110,
        0b00000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x34 - 4
    {
        0b00000000,
        0b00000000,
        0b00001100,
        0b00011100,
        0b00111100,
        0b01101100,
        0b11001100,
        0b11001100,
        0b11111110,
        0b00001100,
        0b00001100,
        0b00011110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x35 - 5
    {
        0b00000000,
        0b00000000,
        0b11111110,
        0b11000000,
        0b11000000,
        0b11000000,
        0b11111100,
        0b00000110,
        0b00000110,
        0b00000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x36 - 6
    {
        0b00000000,
        0b00000000,
        0b01111110,
        0b11000000,
        0b11000000,
        0b11000000,
        0b11111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x37 - 7
    {
        0b00000000,
        0b00000000,
        0b11111110,
        0b11000110,
        0b00000110,
        0b00001100,
        0b00011000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x38 - 8
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x39 - 9
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111110,
        0b00000110,
        0b00000110,
        0b00000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x3A - :
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x3B - ;
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00110000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x3C - <
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000110,
        0b00001100,
        0b00011000,
        0b00110000,
        0b01100000,
        0b00110000,
        0b00011000,
        0b00001100,
        0b00000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x3D - =
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01111110,
        0b00000000,
        0b01111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x3E - >
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b01100000,
        0b00110000,
        0b00011000,
        0b00001100,
        0b00000110,
        0b00001100,
        0b00011000,
        0b00110000,
        0b01100000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x3F - ?
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b00001100,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x40 - @
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11011110,
        0b11011110,
        0b11011110,
        0b11011100,
        0b11000000,
        0b01111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x41 - A
    {
        0b00000000,
        0b00000000,
        0b00111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11111110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x42 - B
    {
        0b00000000,
        0b00000000,
        0b11111100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01111100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b11111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x43 - C
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000010,
        0b11000000,
        0b11000000,
        0b11000000,
        0b11000000,
        0b11000010,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x44 - D
    {
        0b00000000,
        0b00000000,
        0b11111100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b11111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x45 - E
    {
        0b00000000,
        0b00000000,
        0b11111110,
        0b01100110,
        0b01100000,
        0b01100010,
        0b01111110,
        0b01100010,
        0b01100000,
        0b01100000,
        0b01100110,
        0b11111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x46 - F
    {
        0b00000000,
        0b00000000,
        0b11111110,
        0b01100110,
        0b01100000,
        0b01100100,
        0b01111100,
        0b01100100,
        0b01100000,
        0b01100000,
        0b01100000,
        0b11110000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x47 - G
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11000000,
        0b11000000,
        0b11011110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111010,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x48 - H
    {
        0b00000000,
        0b00000000,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11111110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x49 - I
    {
        0b00000000,
        0b00000000,
        0b01111110,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b01111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x4A - J
    {
        0b00000000,
        0b00000000,
        0b00011110,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b01111000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x4B - K
    {
        0b00000000,
        0b00000000,
        0b11000110,
        0b11000110,
        0b11001100,
        0b11011000,
        0b11110000,
        0b11110000,
        0b11011000,
        0b11001100,
        0b11000110,
        0b11000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x4C - L
    {
        0b00000000,
        0b00000000,
        0b11110000,
        0b01100000,
        0b01100000,
        0b01100000,
        0b01100000,
        0b01100000,
        0b01100000,
        0b01100010,
        0b01100110,
        0b11111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x4D - M
    {
        0b00000000,
        0b00000000,
        0b11000110,
        0b11101110,
        0b11111110,
        0b11111110,
        0b11010110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x4E - N
    {
        0b00000000,
        0b00000000,
        0b11000110,
        0b11000110,
        0b11100110,
        0b11110110,
        0b11010110,
        0b11011110,
        0b11001110,
        0b11001110,
        0b11000110,
        0b11000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x4F - O
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x50 - P
    {
        0b00000000,
        0b00000000,
        0b11111100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01111100,
        0b01100000,
        0b01100000,
        0b01100000,
        0b11110000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x51 - Q
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11010110,
        0b11011110,
        0b01111100,
        0b00001100,
        0b00001110,
        0b00000000,
        0b00000000
    },
    // 0x52 - R
    {
        0b00000000,
        0b00000000,
        0b11111100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01111100,
        0b01101100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b11100110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x53 - S
    {
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000000,
        0b11000000,
        0b01110000,
        0b00011100,
        0b00000110,
        0b00000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x54 - T
    {
        0b00000000,
        0b00000000,
        0b11111111,
        0b11011011,
        0b10011001,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x55 - U
    {
        0b00000000,
        0b00000000,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x56 - V
    {
        0b00000000,
        0b00000000,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11000011,
        0b01100110,
        0b00111100,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x57 - W
    {
        0b00000000,
        0b00000000,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11011011,
        0b11011011,
        0b11111111,
        0b11100111,
        0b11000011,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x58 - X
    {
        0b00000000,
        0b00000000,
        0b11000011,
        0b11000011,
        0b11000011,
        0b01100110,
        0b00111100,
        0b00111100,
        0b01100110,
        0b11000011,
        0b11000011,
        0b11000011,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x59 - Y
    {
        0b00000000,
        0b00000000,
        0b11000011,
        0b11000011,
        0b11000011,
        0b01100110,
        0b00111100,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x5A - Z
    {
        0b00000000,
        0b00000000,
        0b11111110,
        0b11000110,
        0b10000110,
        0b00001100,
        0b00011000,
        0b00110000,
        0b01100000,
        0b11000010,
        0b11000110,
        0b11111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x5B - [
    {
        0b00000000,
        0b00000000,
        0b00111100,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x5C - '\'
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b10000000,
        0b11000000,
        0b11100000,
        0b01110000,
        0b00111000,
        0b00011100,
        0b00001110,
        0b00000110,
        0b00000010,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x5D - ]
    {
        0b00000000,
        0b00000000,
        0b00111100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00001100,
        0b00111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x5E - ^
    {
        0b00000000,
        0b00010000,
        0b00111000,
        0b01101100,
        0b11000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x5F - _
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11111111,
        0b00000000
    },
    // 0x60 - `
    {
        0b00000000,
        0b00110000,
        0b00110000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x61 - a
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01111000,
        0b00001100,
        0b01111100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b01110110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x62 - b
    {
        0b00000000,
        0b00000000,
        0b11100000,
        0b01100000,
        0b01100000,
        0b01111100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b11111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x63 - c
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000000,
        0b11000000,
        0b11000000,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x64 - d
    {
        0b00000000,
        0b00000000,
        0b00011100,
        0b00001100,
        0b00001100,
        0b01111100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b01111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x65 - e
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11111110,
        0b11000000,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x66 - f
    {
        0b00000000,
        0b00000000,
        0b00011100,
        0b00110110,
        0b00110000,
        0b00110000,
        0b11111100,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b01111000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x67 - g
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01110110,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b01111100,
        0b00001100,
        0b11001100,
        0b01111000,
        0b00000000
    },
    // 0x68 - h
    {
        0b00000000,
        0b00000000,
        0b11100000,
        0b01100000,
        0b01100000,
        0b01111100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b11100110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x69 - i
    {
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00111000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x6A - j
    {
        0b00000000,
        0b00000000,
        0b00000110,
        0b00000110,
        0b00000000,
        0b00001110,
        0b00000110,
        0b00000110,
        0b00000110,
        0b00000110,
        0b00000110,
        0b00000110,
        0b11000110,
        0b11000110,
        0b01111100,
        0b00000000
    },
    // 0x6B - k
    {
        0b00000000,
        0b00000000,
        0b11100000,
        0b01100000,
        0b01100000,
        0b01100110,
        0b01101100,
        0b01111000,
        0b01111000,
        0b01101100,
        0b01100110,
        0b11100110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x6C - l
    {
        0b00000000,
        0b00000000,
        0b00111000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x6D - m
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11101110,
        0b11111111,
        0b11011011,
        0b11011011,
        0b11011011,
        0b11000011,
        0b11000011,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x6E - n
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11011100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x6F - o
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x70 - p
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11011100,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01100110,
        0b01111100,
        0b01100000,
        0b01100000,
        0b11110000,
        0b00000000
    },
    // 0x71 - q
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01110110,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b01111100,
        0b00001100,
        0b00001100,
        0b00011110,
        0b00000000
    },
    // 0x72 - r
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11011100,
        0b01110110,
        0b01100110,
        0b01100000,
        0b01100000,
        0b01100000,
        0b11110000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x73 - s
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b01111100,
        0b11000110,
        0b11000000,
        0b01111100,
        0b00000110,
        0b11000110,
        0b01111100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x74 - t
    {
        0b00000000,
        0b00000000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b11111100,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110110,
        0b00011100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x75 - u
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b11001100,
        0b01110110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x76 - v
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11000011,
        0b11000011,
        0b11000011,
        0b11000011,
        0b01100110,
        0b00111100,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x77 - w
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11000011,
        0b11000011,
        0b11011011,
        0b11011011,
        0b11011011,
        0b11111111,
        0b01100110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x78 - x
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11000110,
        0b11000110,
        0b01101100,
        0b00111000,
        0b01101100,
        0b11000110,
        0b11000110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x79 - y
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11000110,
        0b01111110,
        0b00000110,
        0b00001100,
        0b11111000,
        0b00000000
    },
    // 0x7A - z
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b11111110,
        0b10000110,
        0b00001100,
        0b00011000,
        0b00110000,
        0b01100010,
        0b11111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x7B - {
    {
        0b00000000,
        0b00000000,
        0b00011100,
        0b00110000,
        0b00110000,
        0b00110000,
        0b11100000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00110000,
        0b00011100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x7C - |
    {
        0b00000000,
        0b00000000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x7D - }
    {
        0b00000000,
        0b00000000,
        0b01110000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00001110,
        0b00011000,
        0b00011000,
        0b00011000,
        0b00011000,
        0b01110000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x7E - ~
    {
        0b00000000,
        0b00000000,
        0b01110110,
        0b11011100,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
    // 0x7F - DEL
    {
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00010000,
        0b00111000,
        0b01101100,
        0b11000110,
        0b11000110,
        0b11000110,
        0b11111110,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000,
        0b00000000
    },
};

void vga_load_font(void) {
    // Save current state
    uint8_t seq2, seq4, gc5, gc6;
    
    // Read current sequencer register 2 and 4
    outb(0x3C4, 0x02); seq2 = inb(0x3C5);
    outb(0x3C4, 0x04); seq4 = inb(0x3C5);
    
    // Read current graphics controller register 5 and 6
    outb(0x3CE, 0x05); gc5 = inb(0x3CF);
    outb(0x3CE, 0x06); gc6 = inb(0x3CF);
    
    // Set up sequencer for font loading
    // Turn off even/odd (allow access to full memory)
    outb(0x3C4, 0x02); outb(0x3C5, 0x04); // Select plane 2
    outb(0x3C4, 0x04); outb(0x3C5, 0x07); // Sequential mode
    
    // Set up graphics controller for font loading
    outb(0x3CE, 0x05); outb(0x3CF, 0x00); // Disable odd/even, enable all planes
    outb(0x3CE, 0x06); outb(0x3CF, 0x00); // Map to A0000-AFFFF
    
    // Load font data into video memory plane 2
    uint8_t* font_mem = (uint8_t*)virtual_address(0xA0000);
    
    // Clear font memory first
    memsetq(font_mem, 0, 1024);

    // Load our font data (characters 0x20-0x7F)
    for (int char_index = 0; char_index < 96; char_index++) {
        int char_code = char_index + 0x20; // Start from space character
        uint8_t* char_ptr = (uint8_t*)(font_mem + char_code * 32);
        
        // Copy 16 bytes of font data for this character
        memory_copy(char_ptr, vga_font[char_index], 16);
    }
    
    // Restore original state
    outb(0x3C4, 0x02); outb(0x3C5, seq2);
    outb(0x3C4, 0x04); outb(0x3C5, seq4);
    outb(0x3CE, 0x05); outb(0x3CF, gc5);
    outb(0x3CE, 0x06); outb(0x3CF, gc6);
}

void vga_init()
{
    outb(0x3C2, 0x67);  // Color mode, enable video, select clocks
    
    // Sequencer
    outb(0x3C4, 0x00); outb(0x3C5, 0x01);  // Reset
    
    outb(0x3C4, 0x01); outb(0x3C5, 0x00);  // Clocking mode
    outb(0x3C4, 0x02); outb(0x3C5, 0x03);  // Map mask (all planes)
    outb(0x3C4, 0x03); outb(0x3C5, 0x00);  // Char map select  
    outb(0x3C4, 0x04); outb(0x3C5, 0x02);  // Memory mode

    outb(0x3C4, 0x00); outb(0x3C5, 0x03);  // Normal operation
    
    // CRTC
    outb(0x3D4, 0x11); outb(0x3D5, inb(0x3D5) & 0x7f);  // Unlock

    uint8_t crtc[25] = {
        0x5F, // 0: Horizontal Total (number of character clocks per line - 5Fh = 95)
        0x4F, // 1: Horizontal Display End (last displayed character column - 4Fh = 79)
        0x50, // 2: Start Horizontal Blank (column where blanking starts)
        0x82, // 3: End Horizontal Blank (upper 6 bits + bits 0–1: 82h)
        0x55, // 4: Start Horizontal Retrace (column where H-sync pulse starts)
        0x81, // 5: End Horizontal Retrace (upper 6 bits + bits 0–1: 81h)
        0xBF, // 6: Vertical Total (number of scan lines - BFh = 191)
        0x1F, // 7: Overflow (vertical total bits 8–9 + vertical retrace bits 8–9)
        0x00, // 8: Preset Row Scan (row scan start, usually 0)
        0x4F, // 9: Maximum Scan Line (rows per character - 0..15; 0x4F sets 16 scan lines)
        0x00, // 10: Cursor Start (scan line where cursor appears)
        0x0F, // 11: Cursor End (scan line where cursor disappears)
        0x00, // 12: Start Address High (high byte of start of display memory)
        0x00, // 13: Start Address Low  (low byte of start of display memory)
        0x00, // 14: Cursor Address High (high byte of cursor offset)
        0x00, // 15: Cursor Address Low  (low byte of cursor offset)
        0x9C, // 16: Vertical Retrace Start (line where V-sync starts)
        0x8E, // 17: Vertical Retrace End (line where V-sync ends + flags)
        0x8F, // 18: Vertical Display End (last visible scan line)
        0x28, // 19: Offset (number of bytes between start of one row to next in memory)
        0x1F, // 20: Underline Location (scan line where underline appears)
        0x96, // 21: Start Vertical Blank (line where vertical blank starts)
        0xB9, // 22: End Vertical Blank (line where vertical blank ends)
        0xA3, // 23: CRTC Mode Control (text mode, color, etc.)
        0xFF  // 24: Line Compare (used to detect split-screen effects, usually 0xFF)
    };

    for(int i = 0; i < 25; i++) {
        outb(0x3D4, i);
        outb(0x3D5, crtc[i]);
    }
    
    // Graphics Controller
    uint8_t gc_regs[] = {
        0x00,  // 00: Set/reset
        0x00,  // 01: Enable set/reset
        0x00,  // 02: Color compare
        0x00,  // 03: Data rotate
        0x00,  // 04: Read map select
        0x10,  // 05: Graphics mode
        0x0E,  // 06: Memory map select (0xB8000-0xBFFFF)
        0x00,  // 07: Color don't care
        0xFF   // 08: Bit mask
    };
    
    for(int i = 0; i < 9; i++) {
        outb(0x3CE, i);
        outb(0x3CF, gc_regs[i]);
    }

    vga_load_font();

    // Attribute controller
    inb(0x3DA);  // Reset flip-flop
    for(int i = 0; i < 16; i++) {
        outb(0x3C0, i);      // Select palette register i
        outb(0x3C0, i);      // Map to color i (identity mapping)
    }
    outb(0x3C0, 0x10); outb(0x3C0, 0x0C);  // Mode: text, enable line graphics
    outb(0x3C0, 0x11); outb(0x3C0, 0x00);  // Overscan: black
    outb(0x3C0, 0x12); outb(0x3C0, 0x0F);  // Color plane enable: all planes
    outb(0x3C0, 0x13); outb(0x3C0, 0x08);
    outb(0x3C0, 0x20); // unblank 

    // DAC
    uint8_t colors[16][3] = {
        {0,0,0}, {0,0,42}, {0,42,0}, {0,42,42},
        {42,0,0}, {42,0,42}, {42,21,0}, {42,42,42},
        {21,21,21}, {21,21,63}, {21,63,21}, {21,63,63},
        {63,21,21}, {63,21,63}, {63,63,21}, {63,63,63}
    };
    for(int i = 0; i < 16; i++) {
        outb(0x3C8, i);           // Select DAC register
        outb(0x3C9, colors[i][0]); // Red
        outb(0x3C9, colors[i][1]); // Green  
        outb(0x3C9, colors[i][2]); // Blue
    }

    inb(0x3DA);  // Reset flip-flop
    outb(0x3C0, 0x20);  // Enable palette and video output

}